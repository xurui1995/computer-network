# 第四章 网络层
### 功能   
> 负责在不同网络之间尽力转发数据包，基于数据包的IP地址转发，若丢失，不负责重传，也不负责顺序 

### 路由器  
路由器三层设备，物理层，数据链路层，网络层，通过路由表实现转发 。 
会根据信道的情况自动选择和设定路由，以最佳路径，按前后顺序发送信号。
### 网络设备和OSI参考模型关系   
* 计算机通信过程   
1，应用层程序准备要传输的文件   
2，传输层 将文件分段 并编号  
3，网络层 添加目标IP地址源目标IP地址 4，数据链路层 分两种情况  
        使用自己的子网掩码，判断自己在那个网段  使用自己的子网掩码，判断目标地址在哪个网段   
    * 如果是一个网段 ，ARP协议广播解析目标IP地址的MAC 
    * 如果不是一个网段  通过路由器  
    
    5，变成比特流，网线传输   
### ARP协议   
* 主机发送信息时将包含目标IP地址的ARP请求广播到网络上(本网段，不跨路由)的所有主机，并接收返回消息，以此确定目标的物理地址   
* 为IP协议提供服务  
### ICMP协议 网际控制报文协议  
*  ping命令  pathping命令   
* Ping的过程实际上就是ICMP协议工作的过程
### IGMP协议  组播协议 
组播 = 多播  （不同于点对点与广播）   
### 数据包结构  
![此处输入图片的描述][1]  
### 数据包分片  
当数据包比链路最大传输单元大时，就可以被分解为很多的足够小片段，以便能够在其上进行传输 
![此处输入图片的描述][2]
### 数据包TTL 和 协议  
TTL是IP协议包中的一个值，它告诉网络,数据包（例如ICMP包）在网络中的时间是否太长而应被丢弃。  
TTL的初值通常是系统缺省值，每当数据包经过一个路由器,其存活时间就会减1。当其存活时间是0时,主机便取消数据包。

### IP 协议  
> 实现能够学习路由表的协议统称。用于将多个包交换网络连接起来的，它在源地址和目的地址之间传送数据包。


* 静态路由 
静态路由是指由用户或网络管理员手工配置的路由信息。当网络的拓扑结构或链路的状态发生变化时，网络管理员需要手工去修改路由表中相关的静态路由信息。静态路由信息在缺省情况下是私有的，不会传递给其他的路由器。当然，网管员也可以通过对路由器进行设置使之成为共享的。静态路由一般适用于比较简单的网络环境，在这样的环境中，网络管理员易于清楚地了解网络的拓扑结构，便于设置正确的路由信息。
* 动态路由  
 动态路由是与静态路由相对的一个概念，指路由器能够根据路由器之间的交换的特定路由信息自动地建立自己的路由表，并且能够根据链路和节点的变化适时地进行自动调整。当网络中节点或节点间的链路发生故障，或存在其它可用路由时，动态路由可以自行选择最佳的可用路由并继续转发报文。
RIP协议是动态路由协议之一，  周期性广播路由表，跳数，30秒更新一下路由信息，最大跳数15跳


  [1]: https://github.com/xurui1995/computer-network/blob/master/pic/%E6%95%B0%E6%8D%AE%E5%8C%85%E9%A6%96%E9%83%A8.png
  [2]: https://github.com/xurui1995/computer-network/blob/master/pic/%E5%88%86%E7%89%87%E4%B8%BE%E4%BE%8B.png?raw=true